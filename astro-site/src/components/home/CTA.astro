---
import { getEntry } from 'astro:content';

const ctaData = await getEntry('cta', 'home');
const { icon, title, subtitle, actions, features } = ctaData?.data ?? {};

// If any required fields are undefined, don't render the CTA
if (!icon || !title || !subtitle || !actions || !features) {
  return null;
}
---

<!-- CTA Section -->
<section class="relative py-24 bg-gradient-to-br from-[var(--blue-primary)] via-[var(--blue-dark)] to-[var(--blue-deeper)] text-white overflow-hidden">
  <!-- Animated Background Orbs -->
  <div class="absolute inset-0 z-[1] overflow-hidden pointer-events-none">
    <div class="absolute w-[350px] h-[350px] rounded-full blur-[80px] opacity-25 -top-[100px] -right-[80px] bg-[radial-gradient(circle,var(--gold)_0%,transparent_70%)] animate-[float_20s_ease-in-out_infinite]"></div>
    <div class="absolute w-[280px] h-[280px] rounded-full blur-[80px] opacity-25 -bottom-[80px] -left-[40px] bg-[radial-gradient(circle,var(--gold-light)_0%,transparent_70%)] animate-[float_20s_ease-in-out_infinite_10s]"></div>
    <div class="absolute w-[200px] h-[200px] rounded-full blur-[60px] opacity-15 top-1/2 left-1/4 bg-[radial-gradient(circle,var(--blue-light)_0%,transparent_70%)] animate-[float_15s_ease-in-out_infinite_5s]"></div>
  </div>

  <div class="container relative z-[2]">
    <div class="text-center max-w-[900px] mx-auto">
      <!-- Logo -->
      <div class="w-32 h-32 mx-auto mb-8 rounded-2xl animate-[pulseIcon_3s_ease-in-out_infinite]">
        <picture>
          <source srcset="/logos/jdv-logo-square-256.webp" type="image/webp" />
          <img
            src="/logos/jdv-logo-square-256.png"
            alt="JDV Abogados"
            class="w-full h-full rounded-2xl object-cover shadow-[0_8px_32px_rgba(0,0,0,0.3)] border-2 border-[rgba(201,169,97,0.3)]"
            width="128"
            height="128"
          />
        </picture>
      </div>

      <!-- Title -->
      <h2 class="font-[var(--font-display)] text-[clamp(2rem,4vw,3rem)] font-extrabold mb-5 tracking-[-0.01em] bg-gradient-to-br from-white to-[var(--gold-light)] bg-clip-text text-transparent">
        {title}
      </h2>

      <!-- Subtitle -->
      <p class="text-[clamp(1.125rem,2vw,1.375rem)] opacity-95 mb-10 leading-relaxed">
        {subtitle}
      </p>

      <!-- Actions -->
      <div class="flex gap-6 justify-center items-center mb-10 flex-wrap">
        <a
          href="/formulario-contacto"
          class="group relative px-12 py-5 text-xl bg-[var(--gold-gradient)] text-[var(--gold)] border-none rounded-[14px] font-bold shadow-[var(--shadow-gold)] overflow-hidden transition-all duration-200 hover:-translate-y-[3px] hover:scale-[1.02] hover:shadow-[0_2px_4px_0_rgba(0,0,0,0.05),0_8px_16px_0_rgba(0,0,0,0.1),0_20px_40px_0_rgba(201,162,84,0.5)] inline-flex items-center gap-3 no-underline"
        >
          <!-- Shimmer effect -->
          <span class="absolute top-0 -left-full w-full h-full bg-gradient-to-r from-transparent via-white/40 to-transparent animate-[shimmer_3s_infinite] z-[1]"></span>
          <i class="fas fa-calendar-check relative z-[2]"></i>
          <span class="relative z-[2]">{actions.primary.text}</span>
        </a>

        <a 
          href={actions.phone.href} 
          class="flex items-center gap-3 text-xl font-bold text-white no-underline px-8 py-4 bg-white/10 backdrop-blur-lg border-2 border-white/20 rounded-[14px] transition-all duration-200 hover:bg-white/15 hover:border-[var(--gold)] hover:text-[var(--gold-light)] hover:-translate-y-0.5 hover:shadow-[0_8px_20px_rgba(0,0,0,0.2)]"
        >
          <i class={`${actions.phone.icon} text-2xl`}></i>
          <span>{actions.phone.text}</span>
        </a>
      </div>

      <!-- Features -->
      <div class="flex justify-center gap-6 flex-wrap">
        {features.map(feature => (
          <div class="flex items-center gap-2 text-[0.9375rem] opacity-90 px-4 py-3 bg-white/[0.08] rounded-lg backdrop-blur-sm transition-all duration-200 hover:bg-white/[0.12] hover:scale-[1.02] cursor-default">
            <i class={`${feature.icon} text-[var(--gold)] text-lg`}></i>
            <span>{feature.text}</span>
          </div>
        ))}
      </div>
    </div>
  </div>
</section>
