---
interface Stat {
  icon: string;
  number: string;
  label: string;
  suffix?: string;
}

interface Props {
  badge: {
    icon: string;
    text: string;
  };
  title: string;
  subtitle: string;
  foundationText?: string;
  stats?: Stat[];
  cta?: {
    primary: {
      text: string;
      icon: string;
    };
    secondary: {
      text: string;
      icon: string;
      href: string;
    };
  };
  image?: string;
}

const { badge, title, subtitle, foundationText, stats, cta, image } = Astro.props;
---

<section class="relative min-h-[85vh] md:min-h-[90vh] flex items-center pt-24 pb-10 md:pt-28 md:pb-12 lg:pt-32 lg:pb-16 overflow-hidden bg-[var(--blue-deeper)]">
  <!-- Complex Mesh Gradient Background -->
  <div class="absolute inset-0 z-0">
    <div class="absolute top-[-20%] left-[-10%] w-[70%] h-[70%] rounded-full bg-[radial-gradient(circle,rgba(59,130,246,0.4)_0%,transparent_70%)] blur-[120px] animate-[float_20s_ease-in-out_infinite]"></div>
    <div class="absolute bottom-[-10%] right-[-5%] w-[60%] h-[60%] rounded-full bg-[radial-gradient(circle,rgba(29,78,216,0.4)_0%,transparent_70%)] blur-[100px] animate-[float_25s_ease-in-out_infinite_reverse]"></div>
    <div class="absolute top-[40%] left-[30%] w-[40%] h-[40%] rounded-full bg-[radial-gradient(circle,rgba(201,162,84,0.15)_0%,transparent_70%)] blur-[80px] animate-[float_15s_ease-in-out_infinite_5s]"></div>
  </div>

  <!-- Noise Texture Overlay -->
  <div class="absolute inset-0 z-[2] opacity-[0.03] pointer-events-none mix-blend-overlay" style="background-image: url('data:image/svg+xml,%3Csvg viewBox=\'0 0 200 200\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cfilter id=\'noise\'%3E%3CfeTurbulence type=\'fractalNoise\' baseFrequency=\'0.65\' numOctaves=\'3\' stitchTiles=\'stitch\'/%3E%3C/filter%3E%3Crect width=\'100%25\' height=\'100%25\' filter=\'url(%23noise)\'/%3E%3C/svg%3E');"></div>

  <!-- Gradient Overlay for Legibility -->
  <div class="absolute inset-0 z-[3] bg-gradient-to-br from-[rgba(12,35,64,0.98)] via-[rgba(12,35,64,0.94)] to-[rgba(26,77,122,0.88)]"></div>

  <!-- Main Container -->
  <div class="relative z-10 w-full max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 lg:gap-12 items-center">
      
      <!-- Content - Left Side -->
      <div class="text-white lg:col-span-7">
        <!-- Badge -->
        <div class="about-hero-badge inline-flex items-center gap-2 px-3 py-1.5 sm:px-4 sm:py-2 bg-white/10 backdrop-blur-lg rounded-full border border-white/20 text-xs sm:text-sm font-semibold mb-4 sm:mb-5 shadow-lg">
          <i class={`${badge.icon} text-[var(--gold)] text-sm sm:text-base`}></i>
          <span class="leading-tight">{badge.text}</span>
        </div>

        <!-- Title -->
        <h1 class="about-hero-title text-[clamp(2.5rem,5vw,4rem)] font-black leading-[1.05] mb-5 sm:mb-6 tracking-[-0.02em]">
          <span class="inline-block bg-gradient-to-br from-[#FDFBF7] via-[#E5D5AA] to-[#C9A254] bg-clip-text text-transparent drop-shadow-[0_2px_4px_rgba(0,0,0,0.3)]" style="font-family: var(--font-display);">
            {title}
          </span>
        </h1>

        <!-- Subtitle -->
        <p class="about-hero-subtitle text-base sm:text-lg leading-relaxed text-white/90 mb-6 max-w-[580px]">
          {subtitle}
        </p>

        <!-- Foundation Text -->
        {foundationText && (
          <p class="about-hero-foundation text-sm sm:text-base leading-relaxed text-white/80 mb-8 max-w-[580px] p-4 bg-white/5 backdrop-blur-sm border-l-4 border-[var(--gold)] rounded-r-lg">
            {foundationText}
          </p>
        )}

        <!-- Stats Grid -->
        {stats && stats.length > 0 && (
          <div class="about-hero-stats grid grid-cols-3 gap-4 mb-8">
            {stats.map((stat, index) => (
              <div 
                class="stat-card p-4 bg-white/10 backdrop-blur-lg border border-white/20 rounded-xl text-center hover:bg-white/15 transition-all duration-300 hover:scale-105"
                data-index={index}
              >
                <div class="w-10 h-10 flex items-center justify-center bg-[var(--gold)]/20 rounded-lg mx-auto mb-2">
                  <i class={`${stat.icon} text-[var(--gold)]`}></i>
                </div>
                <div class="stat-number text-2xl font-bold text-[var(--gold)]" data-target={stat.number} data-suffix={stat.suffix || ""}>
                  0{stat.suffix || ""}
                </div>
                <div class="text-xs text-white/70 mt-1">{stat.label}</div>
              </div>
            ))}
          </div>
        )}

        <!-- CTAs -->
        {cta && (
          <div class="about-hero-ctas flex flex-col sm:flex-row gap-4">
            <a 
              href="https://wa.me/56965870256?text=Necesito%20m%C3%A1s%20informaci%C3%B3n%20porque%20estoy%20interesado%20en%20recibir%20asesor%C3%ADa%20legal"
              target="_blank"
              rel="noopener noreferrer"
              class="group relative px-6 py-4 text-base bg-gradient-to-br from-[#1a365d] via-[#1e3a5f] to-[#0f172a] border-2 border-[rgba(201,169,97,0.4)] rounded-xl font-bold shadow-[0_4px_20px_rgba(0,0,0,0.3),0_0_30px_rgba(201,169,97,0.15)] overflow-hidden transition-all duration-200 hover:translate-y-[-2px] hover:scale-[1.02] hover:border-[rgba(201,169,97,0.6)] hover:shadow-[0_8px_30px_rgba(0,0,0,0.4),0_0_40px_rgba(201,169,97,0.25)] active:scale-[0.98] no-underline text-center"
            >
              <span class="absolute top-0 -left-full w-full h-full bg-gradient-to-r from-transparent via-[rgba(201,169,97,0.3)] to-transparent animate-[shimmer_3s_infinite] z-1"></span>
              <span class="relative z-2 bg-gradient-to-r from-[#C9A961] via-[#E5D5AA] to-[#D4AF37] bg-clip-text text-transparent">{cta.primary.text}</span>
              <i class={`${cta.primary.icon} relative z-2 ml-2 text-[#C9A961] transition-transform group-hover:translate-x-1`}></i>
            </a>
            
            <a 
              href={cta.secondary.href} 
              class="px-6 py-4 text-base bg-white/10 backdrop-blur-lg text-white border-2 border-white/30 rounded-xl font-semibold flex items-center justify-center gap-2 transition-all duration-200 hover:bg-white/20 hover:border-white/50 no-underline"
            >
              <i class={cta.secondary.icon}></i>
              <span>{cta.secondary.text}</span>
            </a>
          </div>
        )}
      </div>

      <!-- Image - Right Side -->
      {image && (
        <div class="relative hidden lg:flex justify-center items-center lg:col-span-5">
          <div class="about-hero-image relative w-full max-w-[480px]">
            <!-- Decorative glow behind image -->
            <div class="absolute inset-0 bg-gradient-to-br from-[var(--gold)]/25 to-[var(--blue-primary)]/25 rounded-3xl blur-[80px] scale-125"></div>
            
            <!-- Image Frame -->
            <div class="relative aspect-[3/4] rounded-3xl overflow-hidden shadow-[0_30px_60px_-15px_rgba(0,0,0,0.5)] bg-white/5 border border-white/10">
              <picture>
                <source srcset={image.replace('.png', '.webp')} type="image/webp">
                <img
                  src={image}
                  alt="Jacqueline Del Valle Inostroza"
                  class="w-full h-full object-cover object-top"
                  loading="eager"
                  decoding="async"
                />
              </picture>
              <!-- Subtle gradient overlay -->
              <div class="absolute inset-0 bg-gradient-to-t from-[rgba(12,35,64,0.4)] via-transparent to-transparent pointer-events-none"></div>
            </div>

            <!-- Name badge at bottom -->
            <div class="about-hero-badge-name absolute -bottom-5 left-1/2 -translate-x-1/2 bg-white/95 backdrop-blur-md rounded-2xl px-6 py-4 shadow-[0_15px_40px_rgba(0,0,0,0.2)] border border-white/50">
              <p class="text-base font-bold text-[var(--gray-900)] text-center">Jacqueline Del Valle</p>
              <p class="text-sm text-[var(--gray-600)] text-center">Abogada Fundadora</p>
            </div>
          </div>
        </div>
      )}
    </div>
  </div>
</section>

<style>
  /* ========================================
     About Hero Premium Animations
     ======================================== */

  /* Badge entrance */
  .about-hero-badge {
    opacity: 0;
    transform: translateY(-15px);
    animation: slideInDown 0.6s ease-out forwards;
  }

  /* Title entrance */
  .about-hero-title {
    opacity: 0;
    transform: translateY(20px);
    animation: fadeInUp 0.8s ease-out 0.1s forwards;
  }

  /* Subtitle entrance */
  .about-hero-subtitle {
    opacity: 0;
    transform: translateY(20px);
    animation: fadeInUp 0.8s ease-out 0.25s forwards;
  }

  /* Foundation text entrance */
  .about-hero-foundation {
    opacity: 0;
    transform: translateX(-20px);
    animation: slideInRight 0.8s ease-out 0.4s forwards;
  }

  /* Stats grid entrance */
  .about-hero-stats {
    opacity: 0;
    transform: translateY(20px);
    animation: fadeInUp 0.8s ease-out 0.5s forwards;
  }

  /* Individual stat cards stagger */
  .stat-card {
    opacity: 0;
    transform: translateY(20px) scale(0.95);
  }

  .stat-card[data-index="0"] {
    animation: fadeInScale 0.6s ease-out 0.7s forwards;
  }

  .stat-card[data-index="1"] {
    animation: fadeInScale 0.6s ease-out 0.8s forwards;
  }

  .stat-card[data-index="2"] {
    animation: fadeInScale 0.6s ease-out 0.9s forwards;
  }

  /* CTAs entrance */
  .about-hero-ctas {
    opacity: 0;
    transform: translateY(20px);
    animation: fadeInUp 0.8s ease-out 0.65s forwards;
  }

  /* Image entrance */
  .about-hero-image {
    opacity: 0;
    transform: scale(0.95) translateY(20px);
    animation: fadeInScale 1s cubic-bezier(0.16, 1, 0.3, 1) 0.3s forwards;
  }

  /* Name badge entrance */
  .about-hero-badge-name {
    opacity: 0;
    transform: translateX(-50%) translateY(10px);
    animation: fadeInUp 0.6s ease-out 1.1s forwards;
  }

  /* Keyframe Animations */
  @keyframes slideInDown {
    from {
      opacity: 0;
      transform: translateY(-15px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slideInRight {
    from {
      opacity: 0;
      transform: translateX(-20px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes fadeInScale {
    from {
      opacity: 0;
      transform: translateY(20px) scale(0.95);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  @keyframes float {
    0%, 100% {
      transform: translateY(0) translateX(0);
    }
    50% {
      transform: translateY(-20px) translateX(10px);
    }
  }

  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    .about-hero-badge,
    .about-hero-title,
    .about-hero-subtitle,
    .about-hero-foundation,
    .about-hero-stats,
    .about-hero-ctas,
    .about-hero-image,
    .about-hero-badge-name,
    .stat-card {
      opacity: 1;
      transform: none;
      animation: none;
    }

    .animate-\[float_20s_ease-in-out_infinite\],
    .animate-\[float_25s_ease-in-out_infinite_reverse\],
    .animate-\[float_15s_ease-in-out_infinite_5s\] {
      animation: none;
    }
  }

  /* Responsive adjustments */
  @media (max-width: 1024px) {
    .about-hero-image {
      max-width: 380px;
    }
  }
</style>

<script is:inline>
  (function() {
    const initAboutHeroCounters = () => {
      const statNumbers = document.querySelectorAll('.stat-number');
      
      if (statNumbers.length === 0) return;

      const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      const animateCounter = (element) => {
        const target = parseInt(element.getAttribute('data-target'));
        const suffix = element.getAttribute('data-suffix') || '';
        const duration = 2000; // 2 seconds
        const frameDuration = 1000 / 60; // 60 FPS
        const totalFrames = Math.round(duration / frameDuration);
        let frame = 0;

        const counter = setInterval(() => {
          frame++;
          const progress = frame / totalFrames;
          const easeOut = 1 - Math.pow(1 - progress, 3); // Cubic ease-out
          const currentValue = Math.round(easeOut * target);

          element.textContent = currentValue + suffix;

          if (frame === totalFrames) {
            clearInterval(counter);
            element.textContent = target + suffix;
          }
        }, frameDuration);
      };

      if (prefersReducedMotion) {
        // Show final values immediately
        statNumbers.forEach(element => {
          const target = element.getAttribute('data-target');
          const suffix = element.getAttribute('data-suffix') || '';
          element.textContent = target + suffix;
        });
        return;
      }

      // Animate counters after page load
      setTimeout(() => {
        statNumbers.forEach(animateCounter);
      }, 800); // Start after initial animations
    };

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initAboutHeroCounters);
    } else {
      initAboutHeroCounters();
    }
  })();
</script>
