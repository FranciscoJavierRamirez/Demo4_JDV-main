---
import { getEntry } from 'astro:content';

const heroData = await getEntry('home', 'hero');

if (!heroData?.data) {
  throw new Error("Hero data not found from content collection");
}

const { badge, title, subtitle, cta, trust, scrollIndicator, images } = heroData.data;

// Process Markdown bold syntax to HTML strong tags
const processedSubtitle = subtitle
  ? subtitle.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
  : '';

---

<section id="hero" class="relative min-h-[85vh] md:min-h-[90vh] flex items-center pt-24 pb-10 md:pt-28 md:pb-12 lg:pt-32 lg:pb-16 overflow-hidden bg-[var(--blue-deeper)]">
  <!-- Complex Mesh Gradient Background -->
  <div class="absolute inset-0 z-0">
    <div class="absolute top-[-20%] left-[-10%] w-[70%] h-[70%] rounded-full bg-[radial-gradient(circle,rgba(59,130,246,0.4)_0%,transparent_70%)] blur-[120px] animate-[float_20s_ease-in-out_infinite]"></div>
    <div class="absolute bottom-[-10%] right-[-5%] w-[60%] h-[60%] rounded-full bg-[radial-gradient(circle,rgba(29,78,216,0.4)_0%,transparent_70%)] blur-[100px] animate-[float_25s_ease-in-out_infinite_reverse]"></div>
    <div class="absolute top-[40%] left-[30%] w-[40%] h-[40%] rounded-full bg-[radial-gradient(circle,rgba(201,162,84,0.15)_0%,transparent_70%)] blur-[80px] animate-[float_15s_ease-in-out_infinite_5s]"></div>
  </div>

  <!-- Justice Statue Image - Golden Metallic Effect -->
  <div class="absolute inset-0 z-[1] pointer-events-none overflow-hidden">
    <img 
      src="/justice-hero.jpg" 
      alt=""
      class="absolute right-[-5%] top-[10%] w-[60%] md:w-[50%] lg:w-[45%] h-auto object-contain opacity-0 md:opacity-100 blur-[1px] mix-blend-overlay"
      style="filter: sepia(100%) saturate(300%) brightness(0.9) hue-rotate(15deg) blur(2px); mask-image: linear-gradient(to left, black 40%, transparent 90%);"
    />
    <!-- Golden overlay for metallic effect -->
    <div class="absolute right-[-5%] top-[10%] w-[60%] md:w-[50%] lg:w-[45%] h-[80%] bg-gradient-to-l from-[rgba(201,169,97,0.15)] via-[rgba(201,169,97,0.08)] to-transparent mix-blend-overlay hidden md:block"></div>
  </div>

  <!-- Noise Texture Overlay -->
  <div class="absolute inset-0 z-[2] opacity-[0.03] pointer-events-none mix-blend-overlay" style="background-image: url('data:image/svg+xml,%3Csvg viewBox=\'0 0 200 200\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cfilter id=\'noise\'%3E%3CfeTurbulence type=\'fractalNoise\' baseFrequency=\'0.65\' numOctaves=\'3\' stitchTiles=\'stitch\'/%3E%3C/filter%3E%3Crect width=\'100%25\' height=\'100%25\' filter=\'url(%23noise)\'/%3E%3C/svg%3E');"></div>

  <!-- Background Image with Overlay -->
  <img 
    src={images.background} 
    alt="Oficina jurÃ­dica moderna JDV" 
    class="absolute inset-0 w-full h-full object-cover z-[0] opacity-40 mix-blend-overlay blur-[2px] scale-105"
  />
  
  <!-- Gradient Overlay for Legibility -->
  <div class="absolute inset-0 z-[3] bg-gradient-to-r from-[rgba(12,35,64,0.98)] via-[rgba(12,35,64,0.92)] to-[rgba(26,77,122,0.75)]"></div>

  <!-- Main Container -->
  <div class="relative z-10 w-full max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 items-center">
      
      <!-- Hero Content -->
      <div class="text-white">
        <!-- Badge -->
        <div class="inline-flex items-center gap-2 px-3 py-1.5 sm:px-4 sm:py-2 bg-white/10 backdrop-blur-lg rounded-full border border-white/20 text-xs sm:text-sm font-semibold mb-4 sm:mb-5 shadow-lg">
          <i class={`${badge.icon} text-[var(--gold)] text-sm sm:text-base`}></i>
          <span class="leading-tight">{badge.text}</span>
        </div>

        <!-- Title -->
        <h1 class="font-[var(--font-display)] text-[clamp(2.5rem,5vw,4rem)] font-black leading-[1.05] mb-5 sm:mb-6 tracking-[-0.02em] animate-[fadeInUp_0.8s_ease-out_forwards]">
          <span class="block text-white drop-shadow-[0_4px_12px_rgba(0,0,0,0.5)]">
            {title.line1}
          </span>
          <span class="inline-block bg-gradient-to-br from-[#FDFBF7] via-[#E5D5AA] to-[#C9A254] bg-clip-text text-transparent drop-shadow-[0_2px_4px_rgba(0,0,0,0.3)]">
            {title.line2}
          </span>
        </h1>

        <!-- Subtitle -->
        <p 
          class="text-base sm:text-lg leading-relaxed text-white/90 mb-6 sm:mb-8 max-w-[540px] [&_strong]:font-semibold [&_strong]:text-[var(--gold-light)] opacity-0 animate-[fadeInUp_0.8s_ease-out_0.2s_forwards]"
          set:html={processedSubtitle}
        ></p>

        <!-- CTAs -->
        <div class="flex flex-col sm:flex-row gap-4 mb-8 sm:mb-10 opacity-0 animate-[fadeInUp_0.8s_ease-out_0.4s_forwards]">
          <button 
            class="group relative px-5 py-3 sm:px-6 sm:py-3.5 text-sm sm:text-base bg-[var(--gold-gradient)] text-[var(--gray-900)] border-none rounded-xl font-bold shadow-[var(--shadow-gold)] overflow-hidden transition-all duration-200 hover:translate-y-[-2px] hover:scale-[1.02] active:scale-[0.98]"
            onclick={cta.primary.action}
          >
            <span class="absolute top-0 -left-full w-full h-full bg-gradient-to-r from-transparent via-white/40 to-transparent animate-[shimmer_3s_infinite] z-[1]"></span>
            <span class="relative z-[2]">{cta.primary.text}</span>
            <i class="fas fa-arrow-right relative z-[2] ml-2"></i>
          </button>
          
          <a 
            href={cta.secondary.href} 
            class="px-5 py-3 sm:px-6 sm:py-3.5 text-sm sm:text-base bg-white/10 backdrop-blur-lg text-white border-2 border-white/30 rounded-xl font-semibold flex items-center justify-center gap-2 transition-all duration-200 hover:bg-white/20 hover:border-white/50"
          >
            <i class={cta.secondary.icon}></i>
            <span>{cta.secondary.text}</span>
          </a>
        </div>

        <!-- Trust Items - Glassed cards grid in new layout -->
        <div class="grid grid-cols-2 gap-3 max-w-[500px]">
          {trust.map((item, index) => (
            <div 
              class={`glass-trust-card flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-300 hover:scale-[1.02] hover:bg-white/15
                ${item.featured 
                  ? 'bg-gradient-to-br from-[var(--gold)] to-[var(--gold-dark)] shadow-[0_4px_20px_rgba(201,169,97,0.35)] col-span-2' 
                  : 'bg-white/10 backdrop-blur-md border border-white/15'}
              `}
              style={`animation: fadeInUp 0.6s ease-out ${0.5 + index * 0.1}s forwards; opacity: 0;`}
            >
              <div class={`w-10 h-10 flex items-center justify-center rounded-lg flex-shrink-0 ${item.featured ? 'bg-white/25' : 'bg-white/10'}`}>
                <i class={`${item.icon} text-base ${item.featured ? 'text-white' : 'text-[var(--gold)]'}`}></i>
              </div>
              <div class={item.featured ? 'text-white' : ''}>
                <strong class="block text-sm font-bold leading-tight">{item.title}</strong>
                <span class={`text-xs ${item.featured ? 'text-white/90' : 'text-white/70'}`}>{item.subtitle}</span>
              </div>
            </div>
          ))}
        </div>
      </div>

      <!-- Hero Visual - Image of Jacqueline (without floating cards) -->
      <div class="relative hidden lg:flex justify-center items-center">
        <!-- Main Image Container -->
        <div class="relative w-full max-w-[380px]">
          <!-- Decorative glow behind image -->
          <div class="absolute inset-0 bg-gradient-to-br from-[var(--gold)]/20 to-[var(--blue-primary)]/20 rounded-2xl blur-[60px] scale-110"></div>
          
          <!-- Image Frame with 4:5 aspect ratio -->
          <div class="relative aspect-[4/5] rounded-2xl overflow-hidden shadow-[0_25px_50px_-12px_rgba(0,0,0,0.5)] bg-white/5 border border-white/10">
            <img 
              src={images.hero}
              alt={images.heroAlt}
              class="w-full h-full object-cover object-top"
            />
            <!-- Subtle gradient overlay -->
            <div class="absolute inset-0 bg-gradient-to-t from-[rgba(12,35,64,0.3)] via-transparent to-transparent pointer-events-none"></div>
          </div>

          <!-- Name badge at bottom -->
          <div class="absolute -bottom-4 left-1/2 -translate-x-1/2 bg-white/95 backdrop-blur-md rounded-xl px-5 py-3 shadow-[0_10px_30px_rgba(0,0,0,0.15)] border border-white/50">
            <p class="text-sm font-bold text-[var(--gray-900)] text-center">Jacqueline Del Valle</p>
            <p class="text-xs text-[var(--gray-600)] text-center">Abogada Fundadora</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Scroll Indicator -->
  <button 
    class="absolute bottom-3 sm:bottom-4 left-1/2 -translate-x-1/2 z-10 flex flex-col items-center gap-1 sm:gap-1.5 text-white opacity-70 cursor-pointer transition-all duration-200 hover:opacity-100 hover:translate-y-[2px] bg-transparent border-none"
    onclick={`document.getElementById('${scrollIndicator.target.slice(1)}').scrollIntoView({behavior: 'smooth'})`}
  >
    <div class="w-8 h-8 sm:w-9 sm:h-9 flex items-center justify-center bg-white/10 backdrop-blur-lg border border-white/20 rounded-full animate-[bounceArrow_2s_ease-in-out_infinite]">
      <i class="fas fa-chevron-down text-sm sm:text-base text-[var(--gold)]"></i>
    </div>
    <span class="text-[9px] sm:text-[10px] font-semibold tracking-wider uppercase hidden sm:block">{scrollIndicator.text}</span>
  </button>
</section>

<style>
  h1 {
    font-family: var(--font-display);
  }

  .glass-trust-card {
    backdrop-filter: blur(12px);
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
