---
import { getEntry } from 'astro:content';

const heroData = await getEntry('home', 'hero');

if (!heroData?.data) {
  throw new Error("Hero data not found from content collection");
}

const { badge, title, subtitle, cta, trust, floatingCards, scrollIndicator, images } = heroData.data;

// Process Markdown bold syntax to HTML strong tags
const processedSubtitle = subtitle
  ? subtitle.replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
  : '';

---

<section id="hero" class="relative min-h-[85vh] md:min-h-[90vh] flex items-center pt-24 pb-10 md:pt-28 md:pb-12 lg:pt-32 lg:pb-16 overflow-hidden bg-[var(--blue-deeper)]">
  <!-- Complex Mesh Gradient Background -->
  <div class="absolute inset-0 z-0">
    <div class="absolute top-[-20%] left-[-10%] w-[70%] h-[70%] rounded-full bg-[radial-gradient(circle,rgba(59,130,246,0.4)_0%,transparent_70%)] blur-[120px] animate-[float_20s_ease-in-out_infinite]"></div>
    <div class="absolute bottom-[-10%] right-[-5%] w-[60%] h-[60%] rounded-full bg-[radial-gradient(circle,rgba(29,78,216,0.4)_0%,transparent_70%)] blur-[100px] animate-[float_25s_ease-in-out_infinite_reverse]"></div>
    <div class="absolute top-[40%] left-[30%] w-[40%] h-[40%] rounded-full bg-[radial-gradient(circle,rgba(201,162,84,0.15)_0%,transparent_70%)] blur-[80px] animate-[float_15s_ease-in-out_infinite_5s]"></div>
  </div>

  <!-- Noise Texture Overlay -->
  <div class="absolute inset-0 z-[1] opacity-[0.03] pointer-events-none mix-blend-overlay" style="background-image: url('data:image/svg+xml,%3Csvg viewBox=\'0 0 200 200\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cfilter id=\'noise\'%3E%3CfeTurbulence type=\'fractalNoise\' baseFrequency=\'0.65\' numOctaves=\'3\' stitchTiles=\'stitch\'/%3E%3C/filter%3E%3Crect width=\'100%25\' height=\'100%25\' filter=\'url(%23noise)\'/%3E%3C/svg%3E');"></div>

  <!-- Background Image with Overlay -->
  <img 
    src={images.background} 
    alt="Oficina jurÃ­dica moderna JDV" 
    class="absolute inset-0 w-full h-full object-cover z-[0] opacity-40 mix-blend-overlay blur-[2px] scale-105"
  />
  
  <!-- Gradient Overlay for Legibility -->
  <div class="absolute inset-0 z-[2] bg-gradient-to-r from-[rgba(12,35,64,0.98)] via-[rgba(12,35,64,0.95)] to-[rgba(26,77,122,0.85)]"></div>

  <!-- Main Container -->
  <div class="relative z-10 w-full max-w-[1400px] mx-auto px-4 sm:px-6 lg:px-8">
    <div class="grid grid-cols-1 md:grid-cols-12 lg:grid-cols-2 gap-6 md:gap-8 lg:gap-12 items-center">
      
      <!-- Hero Content -->
      <div class="text-white md:col-span-7 lg:col-span-1">
        <!-- Badge -->
        <div class="inline-flex items-center gap-2 px-3 py-1.5 sm:px-4 sm:py-2 bg-white/10 backdrop-blur-lg rounded-full border border-white/20 text-xs sm:text-sm font-semibold mb-4 sm:mb-5 shadow-lg">
          <i class={`${badge.icon} text-[var(--gold)] text-sm sm:text-base`}></i>
          <span class="leading-tight">{badge.text}</span>
        </div>

        <!-- Title -->
        <h1 class="font-[var(--font-display)] text-[clamp(2.5rem,5vw,4rem)] font-black leading-[1.05] mb-5 sm:mb-6 tracking-[-0.02em] animate-[fadeInUp_0.8s_ease-out_forwards]">
          <span class="block text-white drop-shadow-[0_4px_12px_rgba(0,0,0,0.5)]">
            {title.line1}
          </span>
          <span class="inline-block bg-gradient-to-br from-[#FDFBF7] via-[#E5D5AA] to-[#C9A254] bg-clip-text text-transparent drop-shadow-[0_2px_4px_rgba(0,0,0,0.3)]">
            {title.line2}
          </span>
        </h1>

        <!-- Subtitle -->
        <p 
          class="text-base sm:text-lg leading-relaxed text-white/90 mb-6 sm:mb-8 max-w-[540px] [&_strong]:font-semibold [&_strong]:text-[var(--gold-light)] opacity-0 animate-[fadeInUp_0.8s_ease-out_0.2s_forwards]"
          set:html={processedSubtitle}
        ></p>

        <!-- CTAs -->
        <div class="flex flex-col sm:flex-row gap-4 mb-8 sm:mb-10 opacity-0 animate-[fadeInUp_0.8s_ease-out_0.4s_forwards]">
          <button 
            class="group relative px-5 py-3 sm:px-6 sm:py-3.5 text-sm sm:text-base bg-[var(--gold-gradient)] text-[var(--gray-900)] border-none rounded-xl font-bold shadow-[var(--shadow-gold)] overflow-hidden transition-all duration-200 hover:translate-y-[-2px] hover:scale-[1.02] active:scale-[0.98]"
            onclick={cta.primary.action}
          >
            <span class="absolute top-0 -left-full w-full h-full bg-gradient-to-r from-transparent via-white/40 to-transparent animate-[shimmer_3s_infinite] z-[1]"></span>
            <span class="relative z-[2]">{cta.primary.text}</span>
            <i class="fas fa-arrow-right relative z-[2] ml-2"></i>
          </button>
          
          <a 
            href={cta.secondary.href} 
            class="px-5 py-3 sm:px-6 sm:py-3.5 text-sm sm:text-base bg-white/10 backdrop-blur-lg text-white border-2 border-white/30 rounded-xl font-semibold flex items-center justify-center gap-2 transition-all duration-200 hover:bg-white/20 hover:border-white/50"
          >
            <i class={cta.secondary.icon}></i>
            <span>{cta.secondary.text}</span>
          </a>
        </div>

        <!-- Trust Items - Responsive grid -->
        <div class="grid grid-cols-2 sm:flex sm:flex-wrap gap-2 sm:gap-3">
          {trust.map(item => (
            <div class={`flex items-center gap-2 px-2.5 py-2 sm:px-3 sm:py-2 rounded-lg ${item.featured ? 'bg-gradient-to-br from-[var(--gold)] to-[var(--gold-light)] shadow-[0_4px_16px_rgba(201,169,97,0.3)] col-span-2 sm:col-span-1' : 'bg-white/10 backdrop-blur-sm border border-white/10'}`}>
              <div class={`w-6 h-6 sm:w-7 sm:h-7 flex items-center justify-center rounded-md flex-shrink-0 ${item.featured ? 'bg-white/25' : 'bg-white/10'}`}>
                <i class={`${item.icon} text-xs sm:text-sm ${item.featured ? 'text-white' : 'text-[var(--gold)]'}`}></i>
              </div>
              <div class={item.featured ? 'text-white' : ''}>
                <strong class="block text-[10px] sm:text-xs font-bold leading-none">{item.title}</strong>
                <span class={`text-[9px] sm:text-[10px] ${item.featured ? 'text-white/90' : 'text-white/70'}`}>{item.subtitle}</span>
              </div>
            </div>
          ))}
        </div>
      </div>

      <!-- Hero Visual - Image with floating cards -->
      <div class="relative hidden md:block md:col-span-5 lg:col-span-1">
        <!-- Main Image Container -->
        <div class="relative mx-auto w-full max-w-[280px] md:max-w-[320px] lg:max-w-[400px]">
          <!-- Image Frame with 4:5 aspect ratio -->
          <div class="relative aspect-[4/5] rounded-xl md:rounded-2xl overflow-hidden shadow-[0_20px_40px_-12px_rgba(0,0,0,0.4)] md:shadow-[0_25px_50px_-12px_rgba(0,0,0,0.5)] bg-white/5">
            <img 
              src={images.hero}
              alt={images.heroAlt}
              class="w-full h-full object-cover object-top"
            />
            <!-- Subtle gradient overlay -->
            <div class="absolute inset-0 bg-gradient-to-t from-[rgba(12,35,64,0.2)] via-transparent to-transparent pointer-events-none"></div>
          </div>

          <!-- Floating Card 1 - Bottom Left -->
          <div 
            class="absolute bottom-4 -left-2 md:bottom-6 md:-left-4 lg:bottom-8 lg:-left-6 bg-white rounded-lg md:rounded-xl p-2 md:p-3 shadow-[0_15px_30px_rgba(0,0,0,0.12)] md:shadow-[0_20px_40px_rgba(0,0,0,0.15)] flex items-center gap-2 md:gap-2.5 animate-[floatCard_6s_ease-in-out_infinite]"
          >
            <div class="w-7 h-7 md:w-8 md:h-8 lg:w-9 lg:h-9 flex items-center justify-center bg-gradient-to-br from-[var(--blue-primary)] to-[var(--blue-dark)] rounded-md md:rounded-lg flex-shrink-0">
              <i class={`${floatingCards[0].icon} text-white text-xs md:text-sm`}></i>
            </div>
            <div>
              <div class="text-base md:text-lg font-extrabold text-[var(--gray-900)] leading-none font-[var(--font-display)]">{floatingCards[0].number}</div>
              <div class="text-[9px] md:text-[10px] text-[var(--gray-500)] font-medium">{floatingCards[0].label}</div>
            </div>
          </div>

          <!-- Floating Card 2 - Top Right -->
          <div 
            class="absolute top-4 -right-2 md:top-6 md:-right-4 lg:top-8 lg:-right-6 bg-white rounded-lg md:rounded-xl p-2 md:p-3 shadow-[0_15px_30px_rgba(0,0,0,0.12)] md:shadow-[0_20px_40px_rgba(0,0,0,0.15)] flex items-center gap-2 md:gap-2.5 animate-[floatCard_6s_ease-in-out_infinite]"
            style="animation-delay: 3s;"
          >
            <div class="w-7 h-7 md:w-8 md:h-8 lg:w-9 lg:h-9 flex items-center justify-center bg-gradient-to-br from-[var(--gold)] to-[var(--gold-dark)] rounded-md md:rounded-lg flex-shrink-0">
              <i class={`${floatingCards[1].icon} text-white text-xs md:text-sm`}></i>
            </div>
            <div>
              <div class="text-base md:text-lg font-extrabold text-[var(--gray-900)] leading-none font-[var(--font-display)]">{floatingCards[1].number}</div>
              <div class="text-[9px] md:text-[10px] text-[var(--gray-500)] font-medium">{floatingCards[1].label}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Scroll Indicator -->
  <button 
    class="absolute bottom-3 sm:bottom-4 left-1/2 -translate-x-1/2 z-10 flex flex-col items-center gap-1 sm:gap-1.5 text-white opacity-70 cursor-pointer transition-all duration-200 hover:opacity-100 hover:translate-y-[2px] bg-transparent border-none"
    onclick={`document.getElementById('${scrollIndicator.target.slice(1)}').scrollIntoView({behavior: 'smooth'})`}
  >
    <div class="w-8 h-8 sm:w-9 sm:h-9 flex items-center justify-center bg-white/10 backdrop-blur-lg border border-white/20 rounded-full animate-[bounceArrow_2s_ease-in-out_infinite]">
      <i class="fas fa-chevron-down text-sm sm:text-base text-[var(--gold)]"></i>
    </div>
    <span class="text-[9px] sm:text-[10px] font-semibold tracking-wider uppercase hidden sm:block">{scrollIndicator.text}</span>
  </button>
</section>

<style>
  h1 {
    font-family: var(--font-display);
  }
</style>
